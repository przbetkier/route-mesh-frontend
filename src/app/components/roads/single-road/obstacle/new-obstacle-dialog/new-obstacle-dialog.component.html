<div id="close-obstacle-dialog-wrapper">
  <mat-icon (click)="dialogRef.close()">close</mat-icon>
</div>

<mat-dialog-content>
  <div class="container obstacle-form">
    <div class="roads-form">

      <h4>Add new obstacle for road {{roadName}}</h4>
      <form [formGroup]="formGroup" #formDirective="ngForm" (ngSubmit)="addObstacle(formDirective)">
        <div class="form-container">
          <div class="row">
            <!-- DEFAULT OBSTACLE PARAMS -->

            <!-- LEFT-->
            <div class="col-6">
              <div class="row">
                <div class="col-12">
                  <mat-form-field>
                    <input matInput formControlName="name" required>
                    <mat-placeholder>Name</mat-placeholder>
                  </mat-form-field>
                </div>
                <div class="col-12">
                  <mat-form-field>
                    <input matInput formControlName="city" required>
                    <mat-placeholder>City</mat-placeholder>
                  </mat-form-field>
                </div>
                <div class="col-12">
                  <mat-form-field>
                    <input matInput type="number" formControlName="latitude" required>
                    <mat-placeholder>Latitude</mat-placeholder>
                  </mat-form-field>
                </div>
                <div class="col-12">
                  <mat-form-field>
                    <input matInput type="number" formControlName="longitude" required>
                    <mat-placeholder>Longitude</mat-placeholder>
                  </mat-form-field>
                </div>
                <div class="col-12">
                  <mat-form-field>
                    <mat-label>Immovable</mat-label>
                    <select matNativeControl required formControlName="immovable">
                      <option value="{{true}}">Yes</option>
                      <option value="{{false}}">No</option>
                    </select>
                  </mat-form-field>
                </div>
              </div>
            </div>
            <!-- RIGHT -->
            <div class="col-6">
              <div class="row">
                <div class="col-12">
                  <mat-form-field>
                    <input matInput type="number" formControlName="milestone" required>
                    <mat-placeholder>Milestone</mat-placeholder>
                  </mat-form-field>
                </div>
                <div class="col-12">
                  <mat-form-field>
                    <input matInput formControlName="url">
                    <mat-placeholder>Url</mat-placeholder>
                  </mat-form-field>
                </div>
                <div class="col-12">
                  <mat-form-field>
                    <input matInput formControlName="comment">
                    <mat-placeholder>Comment</mat-placeholder>
                  </mat-form-field>
                </div>
                <div class="col-12">
                  <mat-form-field>
                    <mat-label>Obstructions</mat-label>
                    <mat-select [formControl]="selectedObstructions" multiple required>
                      <mat-option *ngFor="let obstruction of obstructionTypes" value="{{obstruction}}">{{obstruction}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <!-- HEIGHT OBSTRUCTION PARAMS -->
          <div *ngIf="heightObstructionSelected()">
            <h4>Height obstruction</h4>
            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Subtype</mat-label>
                  <select matNativeControl formControlName="heightSubtype">
                    <option *ngFor="let type of heightObstacleTypes" value="{{type}}">{{type}}</option>
                  </select>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <input matInput type="number" formControlName="heightLimit">
                  <mat-placeholder>Limit</mat-placeholder>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Profile</mat-label>
                  <select matNativeControl formControlName="heightProfile">
                    <option *ngFor="let profile of heightObstacleProfiles" value="{{profile}}">{{profile}}</option>
                  </select>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <input matInput type="number" formControlName="heightRange">
                  <mat-placeholder>Range</mat-placeholder>
                </mat-form-field>
              </div>
              <mat-divider></mat-divider>
            </div>
          </div>

          <!-- WEIGHT OBSTRUCTION PARAMS -->
          <div *ngIf="weightObstructionSelected()">
            <h4>Weight obstruction</h4>
            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Subtype</mat-label>
                  <select matNativeControl formControlName="weightSubtype">
                    <option *ngFor="let type of weightObstacleSubtypes" value="{{type}}">{{type}}</option>
                  </select>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <input matInput type="number" formControlName="weightMlc">
                  <mat-placeholder>MLC</mat-placeholder>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <input matInput type="number" formControlName="weightLimit">
                  <mat-placeholder>Limit</mat-placeholder>
                </mat-form-field>
              </div>
              <mat-divider></mat-divider>
            </div>
          </div>

          <!-- WIDTH OBSTRUCTION PARAMS -->
          <div *ngIf="widthObstructionSelected()">
            <h4>Width obstruction</h4>
            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Subtype</mat-label>
                  <select matNativeControl formControlName="widthSubtype">
                    <option *ngFor="let type of widthObstacleSubtypes" value="{{type}}">{{type}}</option>
                  </select>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <input matInput formControlName="widthLimits">
                  <mat-placeholder>Width limits separated with comma</mat-placeholder>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <input matInput formControlName="widthRanges">
                  <mat-placeholder>Ranges separated with comma</mat-placeholder>
                </mat-form-field>
              </div>
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Symmetric</mat-label>
                  <select matNativeControl formControlName="widthSymmetric">
                    <option value="{{true}}">Yes</option>
                    <option value="{{false}}">No</option>
                  </select>
                </mat-form-field>
              </div>
              <mat-divider></mat-divider>
            </div>
          </div>

        </div>
        <!-- ACTION BUTTONS-->
        <div class="row">
          <div class="col-12 button-section">
            <button mat-raised-button color="primary" type="submit" [disabled]="!isFormValid()">
              Add obstacle
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</mat-dialog-content>
